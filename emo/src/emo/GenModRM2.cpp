/*! \file	GenModRM2.cpp

	\brief	An Enhanced version of RM-MEDA (GenModRM2.cpp)

	\author Aimin ZHOU
	\author Department of Computer Science,
	\author University of Essex,
	\author Colchester, CO4 3SQ, U.K
	\author azhou@essex.ac.uk

	\date	Jan.28 2006 design
	\date	Jun.26 2007 rename
	\date	Oct.22 2007 redesign
	\date   Dec.04 2008 redesign
*/

#include <algorithm>
#include <list>
#include <vector>
#include <cmath>
#include <fstream>
#include <float.h>
#include <numeric>
#include "alg/HCSampler.h"
#include "alg/Kmeans.h"
#include "emo/GenMod.h"
#include "emo/LogFile.h"

#if defined(WIN32)
    #define wxFinite(n) _finite(n)
#elif defined(_LINUX)
    #define wxFinite(n) finite(n)
#else
    #define wxFinite(n) ((n)==(n))
#endif

namespace az
{
namespace mea
{
namespace gen
{
namespace mod
{

double W3D[3][1000]={
	{1.00e+000,0.00e+000,0.00e+000,3.20e-001,6.60e-001,6.60e-001,3.30e-001,3.30e-001,0.00e+000,0.00e+000,4.40e-001,4.40e-001,5.60e-001,7.80e-001,1.00e-001,1.10e-001,1.10e-001,2.20e-001,2.20e-001,7.80e-001,4.50e-001,4.50e-001,4.40e-001,0.00e+000,0.00e+000,0.00e+000,0.00e+000,1.10e-001,1.10e-001,1.10e-001,1.10e-001,1.10e-001,1.10e-001,2.20e-001,2.20e-001,2.20e-001,2.20e-001,3.30e-001,3.30e-001,6.70e-001,8.90e-001,0.00e+000,0.00e+000,3.20e-001,3.20e-001,2.10e-001,2.10e-001,5.50e-001,5.50e-001,6.70e-001,8.90e-001,5.50e-001,5.50e-001,4.20e-001,7.80e-001,5.00e-001,4.00e-001,2.00e-002,7.60e-001,6.50e-001,3.80e-001,3.80e-001,7.10e-001,7.10e-001,6.00e-001,6.00e-001,3.70e-001,3.70e-001,4.80e-001,4.80e-001,4.80e-001,6.20e-001,7.00e-002,7.00e-002,1.80e-001,1.80e-001,8.50e-001,4.00e-002,4.00e-002,4.00e-002,4.00e-002,1.50e-001,1.50e-001,4.00e-001,4.00e-001,5.10e-001,9.20e-001,1.80e-001,1.80e-001,2.90e-001,2.90e-001,3.70e-001,5.10e-001,2.50e-001,2.50e-001,3.90e-001,4.70e-001,7.00e-002,7.00e-002,2.40e-001,2.90e-001,2.90e-001,2.90e-001,2.90e-001,5.10e-001,3.00e-002,1.40e-001,1.40e-001,2.50e-001,2.60e-001,5.90e-001,3.00e-002,8.20e-001,8.00e-002,8.00e-002,1.40e-001,1.40e-001,1.80e-001,1.80e-001,7.40e-001,7.00e-002,1.70e-001,3.00e-002,3.00e-002,7.00e-002,2.50e-001,2.50e-001,8.30e-001,7.20e-001,6.00e-001,3.80e-001,6.40e-001,4.60e-001,1.40e-001,1.40e-001,3.60e-001,7.20e-001,5.60e-001,5.50e-001,5.10e-001,8.10e-001,5.50e-001,6.10e-001,6.60e-001,3.60e-001,4.40e-001,6.10e-001,3.40e-001,3.40e-001,4.40e-001,4.40e-001,2.90e-001,2.90e-001,2.90e-001,4.40e-001,7.00e-002,7.00e-002,1.80e-001,1.80e-001,2.20e-001,0.00e+000,0.00e+000,0.00e+000,0.00e+000,4.00e-002,4.00e-002,1.50e-001,1.50e-001,9.60e-001,9.60e-001,1.10e-001,1.10e-001,5.90e-001,7.00e-002,7.00e-002,1.80e-001,1.80e-001,2.90e-001,6.00e-002,6.00e-002,3.30e-001,3.60e-001,1.10e-001,2.20e-001,2.20e-001,4.00e-001,4.00e-002,4.00e-002,5.10e-001,5.10e-001,7.10e-001,7.20e-001,4.90e-001,5.20e-001,1.40e-001,1.40e-001,1.80e-001,1.80e-001,2.60e-001,2.80e-001,4.90e-001,2.80e-001,3.20e-001,8.50e-001,5.10e-001,5.50e-001,6.80e-001,1.90e-001,1.90e-001,2.50e-001,2.50e-001,2.80e-001,4.20e-001,2.80e-001,3.30e-001,6.80e-001,1.10e-001,4.40e-001,4.40e-001,1.70e-001,1.80e-001,4.00e-001,4.30e-001,4.60e-001,3.30e-001,3.30e-001,7.00e-002,7.00e-002,3.00e-001,5.90e-001,7.80e-001,4.10e-001,4.10e-001,6.70e-001,4.80e-001,8.50e-001,5.70e-001,7.90e-001,3.00e-002,3.00e-002,1.80e-001,3.20e-001,3.50e-001,3.50e-001,3.60e-001,3.70e-001,3.70e-001,4.00e-001,4.80e-001,4.80e-001,4.80e-001,4.80e-001,4.80e-001,5.20e-001,5.20e-001,6.20e-001,6.30e-001,7.40e-001,7.40e-001,1.10e-001,1.10e-001,1.10e-001,1.10e-001,1.10e-001,1.40e-001,1.40e-001,1.40e-001,1.40e-001,1.40e-001,1.40e-001,2.20e-001,2.20e-001,2.60e-001,3.70e-001,3.70e-001,4.00e-001,4.00e-001,6.30e-001,6.40e-001,7.50e-001,8.60e-001,4.00e-002,4.00e-002,4.00e-002,4.00e-002,4.00e-002,4.00e-002,7.00e-002,7.00e-002,7.00e-002,1.10e-001,1.10e-001,1.50e-001,1.50e-001,2.90e-001,2.90e-001,5.60e-001,6.20e-001,8.20e-001,8.80e-001,8.90e-001,0.00e+000,0.00e+000,0.00e+000,0.00e+000,0.00e+000,0.00e+000,0.00e+000,0.00e+000,0.00e+000,0.00e+000,3.00e-002,3.00e-002,3.00e-002,4.00e-002,4.00e-002,7.00e-002,7.00e-002,8.00e-002,8.00e-002,8.00e-002,8.00e-002,8.00e-002,1.00e-001,1.00e-001,1.00e-001,1.30e-001,1.80e-001,1.80e-001,2.10e-001,2.10e-001,2.10e-001,2.10e-001,2.10e-001,2.20e-001,2.20e-001,2.50e-001,2.50e-001,2.50e-001,2.50e-001,2.50e-001,2.90e-001,2.90e-001,3.20e-001,3.20e-001,3.60e-001,4.20e-001,5.10e-001,5.90e-001,6.20e-001,6.30e-001,6.70e-001,7.50e-001,8.10e-001,9.20e-001,9.20e-001,1.40e-001,1.40e-001,2.50e-001,4.00e-002,1.70e-001,2.10e-001,2.50e-001,2.50e-001,2.50e-001,2.90e-001,4.00e-001,5.20e-001,6.70e-001,7.80e-001,5.50e-001,0.00e+000,0.00e+000,0.00e+000,1.40e-001,2.10e-001,3.90e-001,3.90e-001,4.60e-001,5.50e-001,5.90e-001,2.50e-001,4.20e-001,5.80e-001,1.10e-001,1.10e-001,1.80e-001,1.80e-001,7.10e-001,5.90e-001,3.60e-001,7.60e-001,0.00e+000,3.20e-001,3.20e-001,7.80e-001,6.30e-001,6.90e-001,5.30e-001,5.40e-001,3.10e-001,6.50e-001,8.60e-001,7.50e-001,3.10e-001,3.40e-001,3.60e-001,5.30e-001,3.70e-001,4.90e-001,4.10e-001,4.10e-001,5.90e-001,7.00e-001,7.00e-001,3.50e-001,4.50e-001,8.10e-001,4.10e-001,6.90e-001,8.10e-001,7.00e-001,5.90e-001,4.00e-002,3.00e-002,3.00e-002,4.00e-002,7.00e-002,7.00e-002,1.40e-001,1.80e-001,2.10e-001,2.30e-001,2.30e-001,2.50e-001,2.50e-001,2.70e-001,3.10e-001,3.10e-001,3.10e-001,3.40e-001,3.40e-001,3.40e-001,3.80e-001,3.80e-001,4.20e-001,4.20e-001,4.20e-001,4.40e-001,5.10e-001,5.20e-001,5.30e-001,5.50e-001,5.80e-001,6.10e-001,6.40e-001,6.50e-001,3.00e-002,5.00e-002,5.00e-002,5.00e-002,8.00e-002,8.00e-002,9.00e-002,9.00e-002,3.20e-001,3.20e-001,3.20e-001,3.40e-001,3.40e-001,5.10e-001,5.30e-001,6.30e-001,6.80e-001,0.00e+000,0.00e+000,0.00e+000,2.00e-002,2.00e-002,2.00e-002,2.00e-002,2.00e-002,2.00e-002,2.00e-002,2.00e-002,2.00e-002,8.00e-002,1.10e-001,1.10e-001,1.90e-001,1.90e-001,2.20e-001,2.20e-001,2.50e-001,2.50e-001,3.70e-001,3.70e-001,3.80e-001,3.80e-001,4.60e-001,4.60e-001,5.00e-001,5.50e-001,6.40e-001,6.90e-001,7.10e-001,7.30e-001,7.30e-001,8.70e-001,9.00e-001,9.80e-001,7.00e-002,4.40e-001,4.40e-001,5.00e-001,5.30e-001,5.30e-001,8.70e-001,0.00e+000,5.00e-002,9.00e-002,9.00e-002,1.10e-001,1.10e-001,1.10e-001,1.10e-001,1.20e-001,1.40e-001,1.40e-001,1.40e-001,1.40e-001,1.50e-001,1.60e-001,1.60e-001,1.60e-001,1.60e-001,1.60e-001,1.60e-001,1.60e-001,1.80e-001,1.80e-001,1.90e-001,2.00e-001,2.00e-001,2.00e-001,2.00e-001,2.00e-001,2.00e-001,2.20e-001,2.20e-001,2.30e-001,2.30e-001,2.30e-001,2.40e-001,2.40e-001,2.50e-001,2.90e-001,2.90e-001,3.10e-001,3.10e-001,3.30e-001,3.40e-001,3.70e-001,3.70e-001,3.70e-001,4.00e-001,4.40e-001,4.50e-001,4.80e-001,4.90e-001,4.90e-001,5.00e-001,5.10e-001,5.30e-001,5.30e-001,5.30e-001,5.50e-001,5.60e-001,5.80e-001,5.90e-001,5.90e-001,6.00e-001,6.10e-001,6.30e-001,6.30e-001,6.50e-001,6.50e-001,6.60e-001,7.20e-001,7.40e-001,7.60e-001,7.60e-001,7.90e-001,8.00e-001,8.40e-001,0.00e+000,4.00e-002,6.00e-002,1.30e-001,1.30e-001,9.00e-001,2.00e-002,2.00e-002,2.00e-002,2.00e-002,9.60e-001,9.80e-001,2.00e-002,2.00e-002,6.00e-002,6.00e-002,9.20e-001,9.20e-001,9.00e-002,9.00e-002,9.00e-002,9.00e-002,7.10e-001,7.80e-001,8.50e-001,8.50e-001,0.00e+000,2.00e-002,2.00e-002,2.00e-002,2.00e-002,4.00e-002,4.00e-002,9.00e-002,1.30e-001,1.30e-001,1.70e-001,1.70e-001,7.40e-001,7.60e-001,8.90e-001,6.00e-002,6.00e-002,9.00e-002,2.00e-001,2.00e-001,2.30e-001,2.30e-001,7.10e-001,8.10e-001,8.70e-001,0.00e+000,0.00e+000,0.00e+000,6.00e-002,7.00e-002,1.00e-001,1.10e-001,1.10e-001,1.10e-001,1.70e-001,2.00e-001,2.00e-001,2.10e-001,2.10e-001,2.10e-001,2.10e-001,2.60e-001,2.60e-001,2.70e-001,2.70e-001,2.70e-001,2.70e-001,2.70e-001,2.70e-001,2.80e-001,3.00e-001,3.00e-001,3.10e-001,3.10e-001,3.20e-001,3.30e-001,3.50e-001,3.50e-001,3.80e-001,4.00e-001,4.00e-001,4.00e-001,4.40e-001,4.40e-001,4.40e-001,4.60e-001,4.60e-001,4.60e-001,4.60e-001,4.60e-001,4.60e-001,4.80e-001,5.30e-001,6.00e-001,6.10e-001,6.10e-001,6.40e-001,9.00e-002,9.00e-002,1.30e-001,1.30e-001,1.60e-001,1.60e-001,1.60e-001,1.60e-001,1.60e-001,1.60e-001,1.60e-001,1.60e-001,1.80e-001,1.80e-001,2.00e-001,2.00e-001,2.00e-001,2.00e-001,2.20e-001,2.40e-001,2.40e-001,7.20e-001,7.50e-001,5.00e-002,5.00e-002,7.00e-002,8.00e-002,9.00e-002,9.00e-002,2.70e-001,3.50e-001,4.40e-001,4.40e-001,4.60e-001,4.60e-001,5.50e-001,5.90e-001,0.00e+000,2.00e-002,2.70e-001,2.70e-001,5.00e-001,5.20e-001,4.00e-002,2.70e-001,2.70e-001,3.60e-001,3.60e-001,4.60e-001,4.60e-001,9.00e-002,9.00e-002,1.20e-001,1.20e-001,1.40e-001,1.50e-001,1.60e-001,1.60e-001,1.80e-001,1.80e-001,1.90e-001,1.90e-001,2.30e-001,2.70e-001,2.70e-001,2.80e-001,3.40e-001,3.40e-001,3.40e-001,3.50e-001,3.90e-001,4.20e-001,4.20e-001,4.20e-001,4.40e-001,4.40e-001,4.60e-001,4.60e-001,4.60e-001,4.80e-001,4.80e-001,4.80e-001,4.90e-001,5.80e-001,0.00e+000,0.00e+000,8.00e-002,1.20e-001,1.20e-001,1.40e-001,1.80e-001,1.80e-001,1.90e-001,2.40e-001,2.90e-001,3.10e-001,3.10e-001,3.60e-001,4.20e-001,4.20e-001,4.20e-001,4.30e-001,4.30e-001,4.60e-001,4.80e-001,4.80e-001,4.80e-001,5.50e-001,5.80e-001,6.80e-001,6.80e-001,6.90e-001,7.00e-001,8.00e-001,5.00e-002,5.00e-002,7.00e-002,7.00e-002,1.30e-001,1.30e-001,2.50e-001,2.50e-001,3.10e-001,5.70e-001,6.90e-001,0.00e+000,0.00e+000,0.00e+000,0.00e+000,2.00e-002,2.00e-002,2.00e-002,6.00e-002,6.00e-002,1.50e-001,1.50e-001,2.90e-001,2.90e-001,5.70e-001,5.70e-001,9.40e-001,9.40e-001,2.00e-002,2.00e-002,4.00e-002,4.00e-002,9.40e-001,9.40e-001,0.00e+000,4.00e-002,7.00e-002,7.00e-002,9.00e-002,9.00e-002,1.10e-001,1.10e-001,1.10e-001,1.10e-001,1.30e-001,1.30e-001,1.40e-001,1.40e-001,1.60e-001,1.60e-001,1.60e-001,1.60e-001,2.00e-001,2.00e-001,2.00e-001,2.20e-001,2.30e-001,2.30e-001,2.60e-001,2.90e-001,5.70e-001,6.70e-001,8.30e-001,9.00e-002,9.00e-002,1.40e-001,1.40e-001,2.70e-001,2.70e-001,2.70e-001,5.70e-001,6.00e-002,6.00e-002,6.00e-002,9.00e-002,1.30e-001,1.60e-001,1.60e-001,1.90e-001,2.30e-001,2.70e-001,2.70e-001,2.90e-001,3.00e-001,3.10e-001,3.40e-001,4.10e-001,4.20e-001,4.60e-001,5.30e-001,5.70e-001,5.80e-001,6.60e-001,7.40e-001,6.00e-002,6.00e-002,6.00e-002,9.00e-002,1.20e-001,1.60e-001,1.70e-001,1.70e-001,2.30e-001,2.30e-001,2.50e-001,2.70e-001,2.70e-001,2.70e-001,2.70e-001,3.00e-001,3.00e-001,3.00e-001,3.00e-001,3.10e-001,3.10e-001,3.10e-001,3.40e-001,3.40e-001,3.80e-001,3.80e-001,3.90e-001,3.90e-001,4.10e-001,4.20e-001,4.60e-001,4.70e-001,4.80e-001,5.10e-001,5.10e-001,5.10e-001,6.40e-001,7.60e-001,2.00e-002,4.00e-002,4.00e-002,5.00e-002,3.10e-001,4.20e-001,4.20e-001,5.00e-001,5.40e-001,5.60e-001,8.30e-001,2.00e-002,6.00e-002,9.00e-002,9.00e-002,9.00e-002,1.00e-001,2.60e-001,2.90e-001,3.10e-001,3.80e-001,3.80e-001,4.30e-001,5.30e-001,5.70e-001,6.30e-001,6.60e-001,7.30e-001,7.80e-001,8.70e-001,1.20e-001,3.00e-002,5.00e-002,8.00e-002,8.00e-002,1.20e-001,1.30e-001,1.30e-001,1.30e-001,1.30e-001,1.60e-001,1.60e-001,1.70e-001,2.30e-001,3.00e-001,3.00e-001,3.10e-001,3.10e-001,3.20e-001,3.50e-001,3.60e-001,3.90e-001,3.90e-001,5.00e-001,5.30e-001,5.30e-001},
	{0.00e+000,1.00e+000,0.00e+000,3.40e-001,0.00e+000,3.40e-001,0.00e+000,6.70e-001,3.30e-001,6.70e-001,1.20e-001,4.40e-001,2.20e-001,1.00e-001,4.50e-001,1.10e-001,7.80e-001,2.20e-001,5.60e-001,2.20e-001,0.00e+000,5.50e-001,3.20e-001,1.10e-001,2.20e-001,7.80e-001,8.90e-001,0.00e+000,2.20e-001,3.30e-001,5.60e-001,6.70e-001,8.90e-001,0.00e+000,1.10e-001,6.70e-001,7.80e-001,1.10e-001,5.60e-001,2.20e-001,1.10e-001,4.40e-001,5.60e-001,2.30e-001,4.50e-001,3.40e-001,4.50e-001,1.10e-001,3.30e-001,1.00e-001,0.00e+000,4.40e-001,0.00e+000,2.30e-001,0.00e+000,2.00e-001,4.00e-001,4.90e-001,1.70e-001,1.70e-001,2.00e-002,6.00e-001,2.00e-002,2.70e-001,2.60e-001,1.30e-001,1.40e-001,4.90e-001,3.60e-001,4.00e-002,4.80e-001,3.10e-001,4.10e-001,5.20e-001,3.00e-001,5.20e-001,8.00e-002,4.00e-002,1.50e-001,8.10e-001,9.20e-001,4.00e-002,8.10e-001,7.00e-002,5.30e-001,4.10e-001,4.00e-002,1.80e-001,6.40e-001,1.90e-001,5.20e-001,3.60e-001,2.90e-001,2.70e-001,4.80e-001,1.90e-001,1.60e-001,2.90e-001,6.40e-001,3.80e-001,7.00e-002,6.40e-001,3.00e-001,4.10e-001,8.00e-002,6.00e-001,2.60e-001,6.00e-001,6.00e-001,1.40e-001,3.00e-002,3.70e-001,3.00e-002,1.80e-001,7.40e-001,3.70e-001,4.80e-001,8.00e-002,7.40e-001,7.00e-002,8.00e-002,4.10e-001,2.60e-001,7.10e-001,8.50e-001,4.00e-002,7.10e-001,1.60e-001,1.40e-001,3.80e-001,3.00e-001,6.00e-002,2.60e-001,1.40e-001,7.20e-001,2.60e-001,2.20e-001,3.70e-001,1.70e-001,2.40e-001,1.30e-001,2.90e-001,1.70e-001,2.70e-001,4.50e-001,4.00e-001,2.10e-001,6.00e-002,6.00e-001,8.00e-002,4.80e-001,0.00e+000,6.00e-001,7.10e-001,3.60e-001,3.70e-001,5.60e-001,2.20e-001,6.00e-001,1.80e-001,4.00e-002,1.50e-001,8.50e-001,9.60e-001,0.00e+000,9.60e-001,0.00e+000,8.50e-001,0.00e+000,4.00e-002,4.00e-002,8.50e-001,7.00e-002,3.30e-001,6.00e-001,2.60e-001,5.60e-001,5.60e-001,4.50e-001,4.90e-001,1.80e-001,4.00e-001,5.20e-001,2.60e-001,5.20e-001,4.40e-001,2.20e-001,7.40e-001,1.60e-001,3.70e-001,6.00e-002,1.80e-001,0.00e+000,4.00e-002,1.80e-001,6.80e-001,1.40e-001,6.80e-001,1.80e-001,4.90e-001,5.10e-001,2.30e-001,1.50e-001,4.00e-002,1.20e-001,7.00e-002,1.30e-001,4.00e-002,7.70e-001,3.10e-001,4.20e-001,3.80e-001,2.90e-001,3.40e-001,5.20e-001,1.80e-001,4.10e-001,4.00e-002,5.20e-001,4.90e-001,4.40e-001,1.50e-001,1.60e-001,2.00e-001,3.00e-001,3.70e-001,2.50e-001,6.80e-001,1.00e-001,3.00e-001,6.00e-002,3.00e-002,5.60e-001,3.00e-001,2.80e-001,1.20e-001,2.50e-001,1.80e-001,4.00e-001,5.70e-001,3.30e-001,4.90e-001,2.00e-002,6.30e-001,1.90e-001,7.00e-002,5.60e-001,3.60e-001,8.00e-002,1.20e-001,3.20e-001,4.00e-001,4.40e-001,3.20e-001,4.80e-001,3.00e-002,1.30e-001,2.00e-002,2.40e-001,1.40e-001,2.60e-001,3.70e-001,6.30e-001,7.50e-001,2.20e-001,3.00e-001,3.30e-001,5.30e-001,5.60e-001,6.40e-001,1.40e-001,6.40e-001,1.10e-001,1.10e-001,5.20e-001,1.10e-001,4.90e-001,2.60e-001,2.20e-001,1.40e-001,0.00e+000,7.00e-002,2.90e-001,3.20e-001,6.30e-001,6.70e-001,8.80e-001,1.50e-001,7.80e-001,8.90e-001,7.00e-002,8.20e-001,7.00e-002,7.80e-001,4.00e-002,6.70e-001,4.00e-001,3.40e-001,7.00e-002,8.00e-002,4.00e-002,8.00e-002,1.80e-001,2.50e-001,3.70e-001,4.00e-001,6.00e-001,6.30e-001,7.40e-001,8.10e-001,9.20e-001,1.10e-001,4.40e-001,5.20e-001,1.90e-001,7.70e-001,1.10e-001,8.20e-001,0.00e+000,4.00e-002,2.10e-001,7.10e-001,9.20e-001,3.00e-001,4.90e-001,6.00e-001,4.50e-001,0.00e+000,8.20e-001,8.00e-002,3.00e-001,4.90e-001,6.10e-001,7.10e-001,4.00e-002,7.40e-001,0.00e+000,2.20e-001,5.30e-001,5.70e-001,7.50e-001,2.60e-001,4.50e-001,2.60e-001,4.20e-001,2.20e-001,2.00e-001,4.40e-001,1.00e-001,0.00e+000,1.00e-001,3.00e-002,1.00e-001,0.00e+000,0.00e+000,8.00e-002,1.10e-001,7.50e-001,6.40e-001,8.50e-001,3.80e-001,3.70e-001,8.00e-002,3.40e-001,6.70e-001,1.40e-001,3.30e-001,0.00e+000,7.00e-002,3.00e-002,4.00e-002,2.90e-001,4.70e-001,7.10e-001,4.10e-001,4.10e-001,2.30e-001,2.60e-001,2.30e-001,1.40e-001,0.00e+000,4.50e-001,2.60e-001,1.70e-001,1.80e-001,7.10e-001,1.10e-001,7.10e-001,1.00e-001,3.40e-001,3.30e-001,2.00e-001,5.20e-001,5.00e-002,6.30e-001,1.30e-001,3.70e-001,2.40e-001,2.00e-001,2.50e-001,6.10e-001,1.40e-001,1.40e-001,4.00e-002,2.10e-001,3.90e-001,2.90e-001,3.80e-001,4.20e-001,2.30e-001,0.00e+000,5.90e-001,4.10e-001,0.00e+000,3.00e-001,4.80e-001,2.90e-001,1.00e-001,4.60e-001,1.50e-001,1.90e-001,2.10e-001,2.00e-001,5.40e-001,3.50e-001,4.60e-001,6.50e-001,3.10e-001,6.20e-001,5.00e-001,4.60e-001,5.90e-001,3.00e-001,4.10e-001,2.50e-001,5.00e-001,2.90e-001,3.20e-001,3.70e-001,5.40e-001,1.50e-001,3.20e-001,4.30e-001,3.80e-001,4.60e-001,8.00e-002,1.20e-001,5.00e-001,1.80e-001,3.50e-001,1.80e-001,4.20e-001,2.00e-001,2.80e-001,7.00e-002,3.20e-001,3.00e-002,1.30e-001,2.40e-001,4.10e-001,7.10e-001,4.30e-001,4.90e-001,2.60e-001,6.50e-001,3.00e-002,8.00e-002,6.50e-001,8.00e-002,5.80e-001,4.60e-001,1.30e-001,2.80e-001,2.70e-001,2.00e-002,4.90e-001,9.80e-001,1.90e-001,2.20e-001,3.10e-001,6.50e-001,6.70e-001,7.60e-001,7.90e-001,8.70e-001,9.00e-001,2.00e-002,2.00e-002,8.70e-001,2.00e-002,7.90e-001,2.00e-002,7.60e-001,2.00e-002,7.30e-001,0.00e+000,6.30e-001,4.00e-002,5.80e-001,2.00e-002,5.20e-001,2.00e-002,2.00e-002,3.40e-001,4.00e-002,2.50e-001,0.00e+000,2.70e-001,2.00e-002,8.00e-002,0.00e+000,8.70e-001,6.00e-002,5.00e-001,6.00e-002,6.00e-002,4.40e-001,6.00e-002,1.30e-001,1.10e-001,3.70e-001,5.40e-001,1.60e-001,2.40e-001,6.50e-001,7.30e-001,4.30e-001,2.00e-001,2.40e-001,6.20e-001,6.60e-001,4.30e-001,1.10e-001,1.80e-001,3.00e-001,3.30e-001,5.40e-001,6.60e-001,7.30e-001,2.00e-001,6.20e-001,4.90e-001,1.40e-001,1.80e-001,2.00e-001,2.60e-001,5.40e-001,6.60e-001,2.40e-001,5.40e-001,3.40e-001,4.50e-001,5.90e-001,1.10e-001,1.40e-001,6.20e-001,1.70e-001,5.40e-001,5.20e-001,5.60e-001,5.40e-001,1.30e-001,9.00e-002,1.60e-001,5.40e-001,3.80e-001,3.80e-001,1.40e-001,3.80e-001,1.40e-001,1.80e-001,3.20e-001,2.60e-001,9.00e-002,2.20e-001,2.90e-001,3.10e-001,3.50e-001,1.50e-001,2.30e-001,3.20e-001,1.50e-001,2.30e-001,1.70e-001,1.90e-001,1.00e-001,2.40e-001,2.00e-001,1.20e-001,1.90e-001,0.00e+000,2.40e-001,1.50e-001,6.00e-002,0.00e+000,8.70e-001,9.00e-001,4.00e-002,0.00e+000,8.70e-001,6.00e-002,0.00e+000,2.00e-002,9.60e-001,9.80e-001,2.00e-002,2.00e-002,6.00e-002,9.20e-001,2.00e-002,9.20e-001,2.00e-002,6.00e-002,6.00e-002,9.00e-002,8.20e-001,8.50e-001,8.00e-002,8.00e-002,6.00e-002,1.00e-001,7.60e-001,9.00e-002,7.40e-001,8.10e-001,8.50e-001,1.70e-001,7.90e-001,8.90e-001,2.00e-002,8.50e-001,4.00e-002,7.90e-001,2.20e-001,2.20e-001,2.00e-002,2.00e-001,7.40e-001,8.70e-001,6.00e-002,7.40e-001,6.00e-002,7.10e-001,4.00e-002,1.50e-001,4.00e-002,2.70e-001,3.50e-001,5.40e-001,4.70e-001,5.40e-001,4.70e-001,3.50e-001,3.90e-001,5.40e-001,3.60e-001,2.80e-001,5.20e-001,3.20e-001,3.90e-001,4.30e-001,4.70e-001,3.60e-001,3.80e-001,0.00e+000,3.20e-001,4.30e-001,4.50e-001,6.20e-001,7.30e-001,3.60e-001,4.70e-001,4.90e-001,3.00e-001,3.90e-001,4.70e-001,2.80e-001,0.00e+000,6.50e-001,3.30e-001,2.80e-001,3.10e-001,4.20e-001,2.00e-001,2.30e-001,2.60e-001,4.00e-002,8.00e-002,3.40e-001,4.00e-001,4.60e-001,5.00e-001,2.60e-001,3.50e-001,3.60e-001,1.00e-001,2.80e-001,0.00e+000,1.30e-001,7.80e-001,9.00e-002,7.80e-001,1.60e-001,2.00e-001,2.20e-001,2.40e-001,6.00e-001,6.20e-001,6.40e-001,6.80e-001,1.60e-001,6.60e-001,1.60e-001,2.40e-001,5.60e-001,6.40e-001,1.60e-001,1.60e-001,2.00e-001,1.60e-001,1.20e-001,3.50e-001,6.00e-001,3.90e-001,4.50e-001,3.50e-001,5.60e-001,6.00e-001,5.40e-001,1.00e-001,4.60e-001,1.00e-001,4.40e-001,9.00e-002,5.00e-002,6.50e-001,6.30e-001,2.00e-002,7.10e-001,4.00e-002,2.00e-002,4.90e-001,6.00e-002,6.70e-001,4.00e-002,6.00e-001,6.00e-002,4.80e-001,3.90e-001,5.20e-001,2.80e-001,6.00e-001,3.50e-001,4.50e-001,2.80e-001,5.60e-001,2.80e-001,5.40e-001,3.60e-001,3.90e-001,4.70e-001,5.40e-001,6.40e-001,1.20e-001,2.10e-001,2.40e-001,4.50e-001,5.20e-001,2.10e-001,3.60e-001,3.80e-001,4.20e-001,3.40e-001,4.20e-001,3.20e-001,3.60e-001,3.80e-001,1.00e-001,3.00e-001,4.20e-001,1.60e-001,1.30e-001,4.20e-001,5.80e-001,4.70e-001,3.00e-001,5.80e-001,3.90e-001,2.40e-001,5.80e-001,4.10e-001,1.80e-001,4.30e-001,0.00e+000,6.90e-001,2.40e-001,3.10e-001,3.40e-001,4.00e-001,0.00e+000,5.70e-001,4.20e-001,6.00e-002,3.40e-001,4.60e-001,2.70e-001,3.80e-001,0.00e+000,3.20e-001,1.00e-001,1.80e-001,3.00e-002,3.70e-001,5.80e-001,1.30e-001,8.00e-001,7.00e-002,8.00e-001,6.00e-002,6.90e-001,5.80e-001,5.00e-002,8.00e-002,6.00e-002,3.10e-001,6.90e-001,9.40e-001,2.90e-001,6.90e-001,8.30e-001,0.00e+000,9.40e-001,2.00e-002,8.30e-001,2.00e-002,6.90e-001,0.00e+000,2.00e-002,0.00e+000,6.00e-002,4.00e-002,9.40e-001,2.00e-002,9.40e-001,2.00e-002,4.00e-002,8.30e-001,8.30e-001,3.50e-001,5.80e-001,1.10e-001,8.00e-001,9.00e-002,2.00e-001,6.90e-001,8.00e-001,4.00e-002,8.30e-001,1.60e-001,7.00e-001,1.40e-001,2.60e-001,5.80e-001,7.00e-001,1.10e-001,2.20e-001,6.90e-001,2.00e-001,8.00e-002,6.90e-001,1.60e-001,5.80e-001,7.00e-002,2.40e-001,1.00e-001,3.30e-001,5.80e-001,2.80e-001,5.80e-001,4.00e-002,5.80e-001,6.90e-001,9.00e-002,5.10e-001,6.70e-001,7.70e-001,2.90e-001,4.70e-001,3.50e-001,4.60e-001,3.40e-001,2.70e-001,1.90e-001,2.20e-001,9.00e-002,3.60e-001,4.10e-001,1.90e-001,1.90e-001,1.50e-001,3.00e-001,2.40e-001,1.20e-001,1.90e-001,6.00e-002,9.00e-002,1.70e-001,2.70e-001,4.30e-001,6.20e-001,4.90e-001,5.10e-001,6.00e-002,7.70e-001,3.60e-001,5.00e-001,5.50e-001,2.60e-001,4.00e-001,4.70e-001,5.10e-001,1.20e-001,2.30e-001,2.70e-001,3.40e-001,1.70e-001,1.90e-001,2.80e-001,2.60e-001,3.50e-001,1.80e-001,4.40e-001,6.00e-002,5.50e-001,1.70e-001,4.40e-001,1.20e-001,1.40e-001,2.00e-001,1.00e-001,2.20e-001,3.90e-001,3.00e-001,6.00e-002,2.50e-001,2.70e-001,6.90e-001,3.30e-001,2.00e-002,4.00e-002,5.30e-001,4.90e-001,4.60e-001,4.20e-001,1.30e-001,5.40e-001,7.00e-002,2.20e-001,4.10e-001,6.90e-001,4.30e-001,9.00e-002,6.20e-001,6.70e-001,1.20e-001,5.00e-001,5.50e-001,1.10e-001,3.10e-001,5.00e-002,3.20e-001,5.00e-002,2.00e-001,1.20e-001,7.60e-001,4.20e-001,3.00e-001,1.60e-001,7.60e-001,1.20e-001,1.30e-001,3.20e-001,5.50e-001,7.40e-001,8.00e-002,7.60e-001,4.30e-001,6.20e-001,5.00e-002,6.50e-001,7.00e-002,1.40e-001,5.90e-001,5.00e-001,1.30e-001,1.30e-001,4.80e-001,4.30e-001,1.50e-001,2.70e-001},
	{0.00e+000,0.00e+000,1.00e+000,3.40e-001,3.40e-001,0.00e+000,6.70e-001,0.00e+000,6.70e-001,3.30e-001,4.40e-001,1.20e-001,2.20e-001,1.20e-001,4.50e-001,7.80e-001,1.10e-001,5.60e-001,2.20e-001,0.00e+000,5.50e-001,0.00e+000,2.40e-001,8.90e-001,7.80e-001,2.20e-001,1.10e-001,8.90e-001,6.70e-001,5.60e-001,3.30e-001,2.20e-001,0.00e+000,7.80e-001,6.70e-001,1.10e-001,0.00e+000,5.60e-001,1.10e-001,1.10e-001,0.00e+000,5.60e-001,4.40e-001,4.50e-001,2.30e-001,4.50e-001,3.40e-001,3.40e-001,1.20e-001,2.30e-001,1.10e-001,1.00e-002,4.50e-001,3.50e-001,2.20e-001,3.00e-001,2.00e-001,4.90e-001,7.00e-002,1.80e-001,6.00e-001,2.00e-002,2.70e-001,2.00e-002,1.40e-001,2.70e-001,4.90e-001,1.40e-001,1.60e-001,4.80e-001,4.00e-002,7.00e-002,5.20e-001,4.10e-001,5.20e-001,3.00e-001,7.00e-002,9.20e-001,8.10e-001,1.50e-001,4.00e-002,8.10e-001,4.00e-002,5.30e-001,7.00e-002,8.00e-002,4.00e-002,6.40e-001,1.80e-001,5.20e-001,1.90e-001,2.70e-001,2.00e-001,4.80e-001,2.70e-001,4.20e-001,3.70e-001,6.40e-001,2.90e-001,3.80e-001,6.40e-001,7.00e-002,4.10e-001,3.00e-001,4.10e-001,3.70e-001,6.00e-001,2.60e-001,1.50e-001,6.00e-001,3.80e-001,6.00e-001,1.50e-001,7.40e-001,1.80e-001,4.90e-001,3.80e-001,7.40e-001,8.00e-002,1.90e-001,8.50e-001,4.20e-001,7.10e-001,2.60e-001,8.00e-002,7.10e-001,4.00e-002,1.00e-002,1.40e-001,2.00e-002,3.20e-001,3.00e-001,2.80e-001,7.20e-001,1.40e-001,3.80e-001,6.00e-002,7.00e-002,2.80e-001,2.50e-001,6.00e-002,1.60e-001,2.20e-001,7.00e-002,1.90e-001,1.60e-001,1.80e-001,6.00e-001,6.00e-002,4.80e-001,8.00e-002,7.10e-001,1.10e-001,0.00e+000,2.00e-001,5.60e-001,3.70e-001,6.00e-001,2.20e-001,6.00e-001,9.60e-001,8.50e-001,1.50e-001,4.00e-002,9.60e-001,0.00e+000,8.50e-001,0.00e+000,4.00e-002,0.00e+000,8.50e-001,4.00e-002,3.40e-001,6.00e-001,3.30e-001,5.60e-001,2.60e-001,1.50e-001,4.90e-001,4.50e-001,4.90e-001,2.40e-001,3.70e-001,5.20e-001,2.60e-001,1.60e-001,7.40e-001,2.20e-001,3.30e-001,1.20e-001,2.30e-001,1.00e-001,5.10e-001,4.40e-001,6.80e-001,1.80e-001,6.80e-001,1.40e-001,5.60e-001,2.30e-001,0.00e+000,4.90e-001,5.30e-001,1.10e-001,3.70e-001,3.80e-001,1.90e-001,7.70e-001,4.00e-002,4.40e-001,3.30e-001,3.40e-001,2.90e-001,3.80e-001,1.50e-001,1.40e-001,4.80e-001,5.20e-001,4.00e-002,3.40e-001,3.80e-001,4.50e-001,4.10e-001,3.40e-001,3.70e-001,3.00e-001,6.80e-001,2.50e-001,6.00e-001,1.10e-001,1.60e-001,5.60e-001,3.00e-002,3.00e-002,2.40e-001,3.00e-002,1.80e-001,3.00e-002,5.70e-001,4.00e-001,4.90e-001,1.90e-001,6.30e-001,2.00e-002,4.50e-001,5.60e-001,7.00e-002,2.40e-001,4.40e-001,4.00e-001,2.00e-001,1.20e-001,8.00e-002,1.60e-001,0.00e+000,3.50e-001,2.40e-001,2.40e-001,2.00e-002,7.50e-001,6.30e-001,5.20e-001,2.60e-001,1.40e-001,6.40e-001,5.60e-001,5.30e-001,3.30e-001,3.00e-001,2.20e-001,6.40e-001,1.40e-001,6.30e-001,5.20e-001,1.10e-001,4.90e-001,1.10e-001,1.10e-001,1.40e-001,1.10e-001,1.40e-001,8.90e-001,6.70e-001,6.40e-001,3.30e-001,2.90e-001,8.00e-002,7.80e-001,1.50e-001,4.00e-002,8.20e-001,7.00e-002,7.80e-001,7.00e-002,6.70e-001,4.00e-002,4.00e-002,4.00e-002,1.10e-001,4.00e-002,7.00e-002,9.20e-001,8.20e-001,7.50e-001,6.30e-001,6.00e-001,4.00e-001,3.70e-001,2.60e-001,1.90e-001,8.00e-002,8.60e-001,5.30e-001,4.50e-001,7.70e-001,1.90e-001,8.20e-001,1.10e-001,9.20e-001,8.80e-001,7.10e-001,2.10e-001,0.00e+000,6.00e-001,4.10e-001,3.00e-001,4.20e-001,8.20e-001,0.00e+000,7.10e-001,4.90e-001,3.00e-001,1.80e-001,8.00e-002,7.40e-001,4.00e-002,7.50e-001,5.30e-001,2.20e-001,1.80e-001,0.00e+000,4.50e-001,2.60e-001,4.20e-001,2.60e-001,4.20e-001,3.80e-001,5.00e-002,3.10e-001,3.80e-001,2.70e-001,3.00e-001,1.50e-001,1.90e-001,8.00e-002,0.00e+000,7.50e-001,1.10e-001,1.10e-001,1.10e-001,4.50e-001,4.20e-001,6.70e-001,4.10e-001,8.00e-002,5.70e-001,2.70e-001,4.80e-001,2.60e-001,1.90e-001,4.10e-001,7.10e-001,5.30e-001,2.90e-001,4.50e-001,3.80e-001,3.80e-001,3.50e-001,3.10e-001,3.10e-001,4.10e-001,3.00e-001,3.20e-001,2.50e-001,7.10e-001,1.80e-001,7.10e-001,1.10e-001,1.90e-001,7.00e-002,3.10e-001,4.00e-002,4.80e-001,6.30e-001,5.00e-002,9.00e-002,0.00e+000,7.00e-002,2.70e-001,2.10e-001,8.00e-002,2.10e-001,0.00e+000,2.10e-001,4.80e-001,2.70e-001,3.50e-001,9.00e-002,2.10e-001,2.80e-001,5.90e-001,0.00e+000,0.00e+000,3.00e-001,0.00e+000,1.70e-001,2.60e-001,9.00e-002,1.30e-001,1.60e-001,0.00e+000,9.00e-002,2.10e-001,4.20e-001,6.20e-001,5.10e-001,3.10e-001,6.20e-001,3.10e-001,3.60e-001,3.60e-001,2.00e-001,4.70e-001,3.60e-001,5.00e-001,2.50e-001,4.40e-001,3.70e-001,3.20e-001,1.50e-001,5.10e-001,3.40e-001,2.30e-001,2.40e-001,1.60e-001,5.00e-001,4.60e-001,8.00e-002,3.80e-001,1.40e-001,3.00e-001,5.00e-002,2.50e-001,1.40e-001,3.20e-001,4.00e-002,3.20e-001,8.40e-001,7.10e-001,5.40e-001,2.40e-001,4.90e-001,4.30e-001,6.50e-001,2.60e-001,6.50e-001,6.00e-001,3.00e-002,5.80e-001,8.00e-002,3.00e-002,3.40e-001,9.00e-002,5.00e-002,9.80e-001,5.10e-001,2.00e-002,7.90e-001,7.60e-001,6.70e-001,3.30e-001,3.10e-001,2.20e-001,1.90e-001,1.10e-001,8.00e-002,9.00e-001,8.70e-001,2.00e-002,7.90e-001,2.00e-002,7.60e-001,2.00e-002,7.30e-001,2.00e-002,6.30e-001,0.00e+000,5.80e-001,4.00e-002,5.20e-001,2.00e-002,4.80e-001,4.30e-001,2.00e-002,2.70e-001,4.00e-002,2.70e-001,0.00e+000,1.10e-001,2.00e-002,2.00e-002,6.00e-002,5.00e-001,6.00e-002,4.40e-001,4.10e-001,3.00e-002,7.00e-002,8.70e-001,8.40e-001,5.40e-001,3.70e-001,7.30e-001,6.50e-001,2.40e-001,1.60e-001,4.50e-001,6.60e-001,6.20e-001,2.40e-001,2.00e-001,4.20e-001,7.30e-001,6.60e-001,5.40e-001,5.10e-001,3.00e-001,1.80e-001,1.10e-001,6.20e-001,2.00e-001,3.20e-001,6.60e-001,6.20e-001,6.00e-001,5.40e-001,2.60e-001,1.40e-001,5.40e-001,2.40e-001,4.30e-001,3.20e-001,1.80e-001,6.50e-001,6.20e-001,1.30e-001,5.40e-001,1.70e-001,1.70e-001,1.30e-001,1.30e-001,5.30e-001,5.40e-001,4.70e-001,9.00e-002,2.20e-001,1.80e-001,4.10e-001,1.40e-001,3.70e-001,3.30e-001,1.80e-001,2.30e-001,3.80e-001,2.50e-001,1.80e-001,1.40e-001,9.00e-002,2.70e-001,1.80e-001,9.00e-002,2.50e-001,1.60e-001,2.00e-001,1.80e-001,2.50e-001,1.10e-001,1.40e-001,1.60e-001,7.00e-002,2.40e-001,0.00e+000,6.00e-002,1.40e-001,1.60e-001,1.30e-001,6.00e-002,9.00e-001,8.70e-001,0.00e+000,4.00e-002,9.80e-001,9.60e-001,2.00e-002,0.00e+000,2.00e-002,0.00e+000,9.20e-001,6.00e-002,9.20e-001,2.00e-002,6.00e-002,2.00e-002,8.50e-001,8.20e-001,9.00e-002,6.00e-002,2.10e-001,1.40e-001,9.00e-002,5.00e-002,2.40e-001,8.90e-001,2.40e-001,1.70e-001,1.30e-001,7.90e-001,1.70e-001,2.00e-002,8.50e-001,2.00e-002,7.90e-001,4.00e-002,4.00e-002,2.00e-002,9.00e-002,7.40e-001,2.00e-001,4.00e-002,7.40e-001,6.00e-002,7.10e-001,6.00e-002,2.50e-001,4.00e-002,9.00e-002,7.30e-001,6.50e-001,4.60e-001,4.70e-001,3.90e-001,4.30e-001,5.40e-001,5.00e-001,3.50e-001,4.70e-001,5.20e-001,2.80e-001,4.70e-001,4.00e-001,3.60e-001,3.20e-001,3.80e-001,3.60e-001,7.30e-001,4.10e-001,3.00e-001,2.80e-001,1.10e-001,0.00e+000,3.60e-001,2.30e-001,2.10e-001,3.90e-001,3.00e-001,2.10e-001,3.90e-001,6.50e-001,0.00e+000,2.90e-001,3.20e-001,2.90e-001,1.80e-001,3.60e-001,3.30e-001,3.00e-001,5.00e-001,4.60e-001,2.00e-001,1.40e-001,8.00e-002,4.00e-002,2.60e-001,1.20e-001,4.00e-002,2.90e-001,1.10e-001,3.60e-001,7.80e-001,1.30e-001,7.80e-001,9.00e-002,6.80e-001,6.40e-001,6.20e-001,6.00e-001,2.40e-001,2.20e-001,2.00e-001,1.60e-001,6.60e-001,1.60e-001,6.40e-001,5.60e-001,2.40e-001,1.60e-001,6.20e-001,6.00e-001,5.60e-001,1.20e-001,1.30e-001,6.00e-001,3.50e-001,5.40e-001,4.70e-001,5.60e-001,3.50e-001,1.30e-001,1.10e-001,4.60e-001,1.00e-001,4.40e-001,1.00e-001,3.60e-001,3.60e-001,3.50e-001,3.50e-001,7.10e-001,2.00e-002,4.60e-001,4.60e-001,4.70e-001,6.70e-001,6.00e-002,6.00e-001,4.00e-002,4.80e-001,6.00e-002,5.20e-001,3.90e-001,6.00e-001,2.80e-001,5.10e-001,4.00e-001,5.60e-001,2.80e-001,5.40e-001,2.80e-001,4.50e-001,4.20e-001,3.00e-001,1.90e-001,9.00e-002,6.00e-001,4.50e-001,4.20e-001,2.10e-001,1.30e-001,4.00e-001,2.20e-001,2.00e-001,1.60e-001,2.20e-001,1.40e-001,2.20e-001,1.80e-001,1.60e-001,4.20e-001,2.20e-001,1.00e-001,3.50e-001,2.90e-001,5.80e-001,4.20e-001,4.50e-001,5.80e-001,3.00e-001,4.70e-001,5.80e-001,2.40e-001,4.00e-001,5.80e-001,2.80e-001,6.90e-001,0.00e+000,4.00e-001,2.70e-001,2.40e-001,1.80e-001,5.70e-001,0.00e+000,1.20e-001,4.60e-001,1.80e-001,6.00e-002,1.80e-001,4.00e-002,3.20e-001,0.00e+000,2.10e-001,1.20e-001,1.70e-001,5.80e-001,3.70e-001,8.00e-001,1.30e-001,8.00e-001,7.00e-002,6.90e-001,6.00e-002,1.10e-001,3.80e-001,2.30e-001,9.40e-001,6.90e-001,3.10e-001,6.00e-002,6.90e-001,2.90e-001,1.50e-001,9.40e-001,0.00e+000,8.30e-001,2.00e-002,6.90e-001,2.00e-002,4.30e-001,4.10e-001,6.00e-002,0.00e+000,9.40e-001,4.00e-002,9.40e-001,2.00e-002,4.00e-002,2.00e-002,1.70e-001,1.30e-001,5.80e-001,3.50e-001,8.00e-001,1.10e-001,8.00e-001,6.90e-001,2.00e-001,9.00e-002,8.30e-001,4.00e-002,7.00e-001,1.60e-001,7.00e-001,5.80e-001,2.60e-001,1.40e-001,6.90e-001,5.80e-001,1.10e-001,5.80e-001,6.90e-001,8.00e-002,5.80e-001,1.30e-001,3.60e-001,9.00e-002,7.00e-002,5.80e-001,3.30e-001,5.80e-001,2.80e-001,6.90e-001,1.50e-001,4.00e-002,3.40e-001,4.30e-001,2.70e-001,1.70e-001,6.20e-001,4.00e-001,4.90e-001,3.80e-001,4.70e-001,5.00e-001,5.40e-001,5.10e-001,6.20e-001,3.40e-001,2.80e-001,4.70e-001,4.00e-001,4.30e-001,2.40e-001,2.30e-001,3.10e-001,2.30e-001,2.80e-001,1.70e-001,7.70e-001,6.70e-001,5.10e-001,2.90e-001,3.90e-001,3.30e-001,7.70e-001,6.00e-002,4.10e-001,2.70e-001,2.00e-001,4.70e-001,3.30e-001,2.60e-001,2.20e-001,5.80e-001,4.70e-001,4.30e-001,3.60e-001,5.20e-001,5.00e-001,4.10e-001,4.00e-001,3.10e-001,4.40e-001,1.80e-001,5.50e-001,6.00e-002,4.20e-001,1.40e-001,4.20e-001,3.90e-001,3.20e-001,3.90e-001,2.70e-001,1.00e-001,6.00e-002,1.80e-001,7.30e-001,6.90e-001,2.70e-001,6.20e-001,6.70e-001,5.40e-001,5.00e-002,1.00e-002,0.00e+000,2.00e-002,4.00e-002,4.40e-001,8.70e-001,6.90e-001,5.00e-001,2.20e-001,4.70e-001,6.50e-001,9.00e-002,2.00e-002,5.00e-001,1.20e-001,2.00e-002,3.60e-001,1.20e-001,3.20e-001,2.00e-002,2.20e-001,2.00e-002,1.00e-002,1.20e-001,5.50e-001,6.50e-001,7.60e-001,1.60e-001,7.60e-001,7.40e-001,5.50e-001,3.20e-001,1.30e-001,7.60e-001,8.00e-002,4.00e-001,1.50e-001,6.50e-001,5.00e-002,6.20e-001,5.50e-001,9.00e-002,1.50e-001,5.10e-001,4.80e-001,1.30e-001,7.00e-002,3.20e-001,2.00e-001}
};

//constructor
RM2::RM2()
{
	//set default parameters
	mUPFExtRatio	= 1.0;
	mModExtRatio	= 1.0;
	mPCAThreshold	= 0.8;
	mNoM			= 20;
	mMinM			= 1;
	mMaxM			= 30;
}

//deconstructor
RM2::~RM2()
{
}

//set parameters
void RM2::Set(double uext, double mext, double threshold, unsigned int minmodel, unsigned int maxmodel)
{
	mUPFExtRatio	= uext;
	mModExtRatio	= mext;
	mPCAThreshold	= threshold;
	mMinM			= minmodel;
	mMaxM			= maxmodel;
	mGen			= 0;

#ifdef AZ_MODEL_OUT
	LogFile log('C');
#endif
}

//model-based generator
CPopulationMO& RM2::Generate(unsigned int sizenew, CPopulationMO& popnew, CPopulationMO& popref)
{
	unsigned int index, newI;

	popnew.Resize(sizenew);

	mNoM = rnd::rand(mMinM, mMaxM+1);

	mNoNew = sizenew; if(mNoNew<1) return popnew;

	mvNoChi.resize(mNoM);	// number of children in each cluster	
	mvDim.resize(mNoM);		// dimension of the manifold in each cluster
	mvStd.resize(mNoM);		// standard deviation of each cluster
	mvDatMat.resize(mNoM);	// matrix to store data for each cluster
	mvPCA.resize(mNoM);
	mvCenM.resize(mNoM);	// centre points

	//Step 1: clustering
	Partition(popref);

	//Step 2: build model
	// assign data to each model
	// dimension of the manifold in each cluster
	// std. (noise) of each model
	// post probability of each model
	BuildModel(popref, mNoNew);

	//Step 3: sample new solutions
#ifdef AZ_MODEL_OUT
	std::ofstream fhand("ModX.out");
	fhand<<mNoM<<std::endl;
	fhand.close();

	LogFile log;
	log<<mGen<<"\t";
#endif
	newI = 0;
	for(index=0; index<mNoM; index++)
	{
		ALModelGen(popnew, newI, popref, mvPCA[index], mvStd[index], mvDim[index], mvNoChi[index]);
#ifdef AZ_MODEL_OUT
	log<<mvDim[index]<<"\t";
#endif
	}
	popnew.Erase(newI);
#ifdef AZ_MODEL_OUT
	log<<"\n";
#endif

	mGen++;
	return popnew;
}

//modle-based generator
//linear model
CPopulationMO& RM2::ALModelGen(CPopulationMO& popnew, unsigned int& index, CPopulationMO& popref, alg::PCA& pca, double std, unsigned int dim, unsigned int size)
{
	unsigned int i,j,k;
	std::vector< double > Tmax, Tmin;
	std::vector< std::vector<double> > T;

	//Step 1: the model is not a single point, set parameters
	if(dim>0)
	{
		double pro, pro1, pro2;
		// projection into primary components
		Tmax.resize(dim); Tmin.resize(dim);
		for(i=0; i<dim; i++) { Tmin[i] = 1.0E200; Tmax[i] = -1.0E200; }
		for(i=0; i<pca.Data().ColSize(); i++)
		{
			for(j=0; j<dim; j++)
			{
				pro = Project(j,i,pca);
				if(pro > Tmax[j]) Tmax[j] = pro;
				if(pro < Tmin[j]) Tmin[j] = pro;
			}
		}

		// sample latent points in the manifold
		double ext = (pow(1.0 + mModExtRatio, 1.0/(dim+0.0))-1.0)*0.5;
		for(i=0; i<dim; i++)
		{
			pro1	= Tmin[i];
			pro2	= Tmax[i];
			Tmin[i] = pro1-ext*(pro2-pro1);
			Tmax[i] = pro2+ext*(pro2-pro1);
		}

		T.resize(dim);
		for(i=0; i<dim; i++) T[i].resize(size);
		alg::LHC(T, Tmin, Tmax);
	}

	//Step 2: sample new trial solutions in decision space
	unsigned int par1;
	for(i=0; i<size; i++)
	{
		par1 = rnd::rand((unsigned int)0, popref.Size());
		for( j=0; j<popref.P().XSize(); j++ )
		{
			popnew[index+i][j] = pca.Mean()[j] + std*rnd::gaussian();
			// !!! if dim == 0, it will be a Gaussian model and the following sentence will be ignored
			for(k=0; k<dim; k++) popnew[index+i][j] += pca.Eigenvector()(j,k)*T[k][i];
			// if it is not a leagle float
			if( wxFinite(popnew[index+i][j]) == 0 ) popnew[index+i][j] = rnd::rand(popnew.P().XLow(j),popnew.P().XUpp(j));

			// boundary checking
			if(popnew[index+i][j] < popnew.P().XLow(j))			popnew[index+i][j] = 0.5*(popnew.P().XLow(j)+popref[par1][j]);
			else if(popnew[index+i][j] > popnew.P().XUpp(j))	popnew[index+i][j] = 0.5*(popnew.P().XUpp(j)+popref[par1][j]);
		}
	}
	index += size;

#ifdef AZ_MODEL_OUT
	std::ofstream fhand("ModX.out",std::ios::app);
	fhand<<std::scientific<<std::setprecision(5);
	switch(dim)
	{
	case 0:
		fhand<<"SPHERE"<<std::endl
			 <<pca.Mean()[0] <<"\t"
			 <<pca.Mean()[1] <<"\t"
			 <<pca.Mean()[2] <<"\t"
			 <<std;
		break;
	case 1:
		fhand<<"LINE"<<std::endl;
		break;
	case 2:
		fhand<<"RECT"<<std::endl;
		break;
	case 3:
		fhand<<"CUBE"<<std::endl;
		break;
	default:
		//fhand<<"ERROR"<<std::endl;
		fhand<<"CUBE"<<std::endl;
		dim = 3;
		break;
	}
	for(i=0; i<dim; i++)
	{
		 fhand<<Tmin[i] * pca.Eigenvector()(0,i) + pca.Mean()[0] <<"\t"
			  <<Tmin[i] * pca.Eigenvector()(1,i) + pca.Mean()[1] <<"\t"
			  <<Tmin[i] * pca.Eigenvector()(2,i) + pca.Mean()[2] <<"\t"
			  <<Tmax[i] * pca.Eigenvector()(0,i) + pca.Mean()[0] <<"\t"
			  <<Tmax[i] * pca.Eigenvector()(1,i) + pca.Mean()[1] <<"\t"
			  <<Tmax[i] * pca.Eigenvector()(2,i) + pca.Mean()[2] <<"\t";
	}
	fhand<<std<<std::endl;
	fhand.close();
#endif

	return popnew;
}

//project point into a dimension
double RM2::Project(unsigned int dim, unsigned int index, alg::PCA& pca)
{
	unsigned int i; double len;
	len = 0.0;
	//projection
	for( i=0; i<pca.Data().RowSize(); i++ ) len += (pca.Data()(i,index) - pca.Mean()[i]) * pca.Eigenvector()(i,dim);
	return len;
}

// choose the neighborhood of each reference point
void RM2::Partition(CPopulationMO& pop)
{
	unsigned int i, j, k, index, noMP, size = pop.Size();

	for(i=0; i<mNoM; i++) mvCenM[i].resize(pop.P().FSize());
	Reference(pop, mvCenM);
	
	noMP = (unsigned int)(2*size/(mNoM+0.0));				// number of points to build a model
	if(noMP > size) noMP = size;

	double dis;
	std::list<double>			ldis;						//neighborhood distance
	std::list<unsigned int>		idis;						//neighborhood index
	std::list<double>::iterator			it1;
	std::list<unsigned int>::iterator	it2;

	alg::Matrix	disMat;										// distance matrix
	disMat.Resize(mNoM, size);
	for(i=0; i<mNoM; i++)									// from centre points to all the points in current population
	{
		for(j=0; j<size; j++)
		{
			disMat(i,j) = 0.0;
			if(mvCenM[i].size()==pop.P().FSize())
			{
				for(k=0; k<pop.P().FSize(); k++) disMat(i,j) += (mvCenM[i][k] - pop[j].F(k))*(mvCenM[i][k] - pop[j].F(k));
			}
			else
			{
				for(k=0; k<pop.P().XSize(); k++) disMat(i,j) += (mvCenM[i][k] - pop[j][k])*(mvCenM[i][k] - pop[j][k]);
			}
			//disMat(i,j) = sqrt(disMat(i,j));				// no need
		}
	}

	for(index=0; index<mNoM; index++)
	{
		//selecte model points from candidate points
		ldis.clear(); idis.clear();
		for(i=0; i<size; i++)
		{
			dis = disMat(index, i);
			it1 = ldis.begin(); it2 = idis.begin();	
			if(!ldis.empty()) while(it1 != ldis.end() && *it1 < dis) {it1++; it2++;}
			ldis.insert(it1, 1, dis); idis.insert(it2, 1, i);
		}
		it2 = idis.begin();
		mvDatMat[index].Resize(pop.P().XSize(), noMP);

//#ifdef AZ_MODEL_OUT
//	CPopulationMO tmp(pop.P());
//	tmp.Resize(noMP);
//#endif
		for(i=0; i<noMP; i++)
		{
			for(j=0; j<pop.P().XSize(); j++) mvDatMat[index](j,i) = pop[*it2][j];
//#ifdef AZ_MODEL_OUT
//			tmp[i] = pop[*it2];
//#endif
			it2++;
		}
//#ifdef AZ_MODEL_OUT
//	char name[20];
//	sprintf(name,"%d.pop",index);
//	tmp.Write(name);
//#endif
	}
}

// set model parameters
void RM2::BuildModel(CPopulationMO& pop, unsigned int sizenew)
{
	unsigned int i, index, dim = pop.P().XSize();

	//Step 1: analyze data (pca)
	for(index=0; index<mNoM; index++)
	{
		mvPCA[index].Data(mvDatMat[index]);
		mvPCA[index].Initialize(dim);
		mvPCA[index].Train();
	}

	//Step 2: set the dimension and std. of each subset
	for(index=0; index<mNoM; index++) mvStd[index]=0.0;
	for(index=0; index<mNoM; index++)
	{
		//Step 2.1: calculate the standard deviation which represents the noise and the dimension of manifold of PS
		double ad	= 0.0;
		mvDim[index]= dim;
		for(i=0; i<dim; i++) ad += fabs(mvPCA[index].Eigenvalue()[i]);
		for(i=0; i<dim; i++)
		{
			mvStd[index] += fabs(mvPCA[index].Eigenvalue()[i]);
			if( mvStd[index] >= mPCAThreshold*ad )
			{
				mvDim[index] = i+1;
				break;
			}
		}

//#define REPAIR_DIM 1
#ifdef REPAIR_DIM
		//Step 2.2: repair standard deviation and dimension
		if(dim > 10 && mvDim[index] >=4)
		{
			mvDim[index]	= 4;
			mvStd[index]	= 0.0;
			for(i=0; i<mvDim[index]; i++) mvStd[index] += fabs(mvPCA[index].Eigenvalue()[i]);
		}
#endif
		mvStd[index] = sqrt((ad-mvStd[index]) / double(dim-mvDim[index]));
	}

	// Step 3: post probability of each model (how many offspring to generate for each model)
	// probability = 1.0/mNoM
	unsigned int tolNo = 0;
	for(index=0; index<mNoM; index++)
	{
		mvNoChi[index]	 = (unsigned int)(double(sizenew)/double(mNoM));
		tolNo			+= mvNoChi[index];
	}
	for(index=0; index<sizenew-tolNo; index++) mvNoChi[rnd::rand((unsigned int)0,mNoM)]++;
}

void RM2::Reference(CPopulationMO& pop, std::vector< std::vector<double> >& cenp)
{
	unsigned int i,j,k,size = (unsigned int)cenp.size();

	// Step 1: find the simplex
	unsigned int dimF = pop.P().FSize();
	std::vector< std::vector< double > > simplex;
	std::vector< double > normal;
	simplex.resize(dimF); for(i=0; i<dimF; i++) simplex[i].resize(dimF);
	normal.resize(dimF);

	// Step 1.1: find the points to form a simplex
	std::vector<double> vmin(dimF); for(k=0; k<dimF; k++) vmin[k] = 1.0E100;
	CPopulationMO poptmp(pop); poptmp.DominateSort();
	for(i=0; i<dimF; i++) simplex[i][i] = -1.0E100;
	for(i=0; i<poptmp.Size(); i++) if(poptmp[i].Rank() == poptmp[0].Rank())
	{
		for(j=0; j<dimF; j++) if(poptmp[i].F(j) > simplex[j][j])
		{
			simplex[j] = poptmp[i].F();
			for(k=0; k<dimF; k++) if(simplex[j][k] < vmin[k]) vmin[k] = simplex[j][k];
		}
	}
	// Step 1.2: find the Quasi-normal direction
	double norm = 0.0;
	if(dimF == 2)
	{
		normal[0] = simplex[1][1] - vmin[1];
		normal[1] = simplex[0][0] - vmin[0];

		//normal[0] =  (simplex[1][1]-simplex[0][1]);
		//normal[1] = -(simplex[1][0]-simplex[0][0]);
	}
	else if(dimF == 3)
	{
		normal[0] = ( (simplex[1][1]-simplex[0][1])*(simplex[2][2]-simplex[0][2])-(simplex[1][2]-simplex[0][2])*(simplex[2][1]-simplex[0][1]) );
		normal[1] = ( (simplex[1][2]-simplex[0][2])*(simplex[2][0]-simplex[0][0])-(simplex[1][0]-simplex[0][0])*(simplex[2][2]-simplex[0][2]) );
		normal[2] = ( (simplex[1][0]-simplex[0][0])*(simplex[2][1]-simplex[0][1])-(simplex[1][1]-simplex[0][1])*(simplex[2][0]-simplex[0][0]) );
		double tmp = ( 0-(normal[0]*simplex[0][0]+normal[1]*simplex[0][1]+normal[2]*simplex[0][2]) );
		double tmp1= normal[0]*vmin[0] + normal[1]*vmin[1] + normal[2]*vmin[2] + tmp;
		if(tmp1>0) for(i=0; i<3; i++) normal[i] *= -1;

	}
	else
	{
		for(i=0; i<dimF; i++)
		{
			normal[i] = 0.0;
			for(k=0; k<dimF; k++) normal[i] += simplex[k][i] - vmin[i];
		}
	}
	for(i=0; i<dimF; i++) norm += normal[i]*normal[i];
	for(i=0; i<dimF; i++) normal[i] /= sqrt(norm);


	// Step 1.3: move the simplex to make it 'dominates' all current points
	double trans = 1.0E100, pro;
	for(i=0; i<pop.Size(); i++)
	{
		pro = 0.0;
		for(j=0; j<dimF; j++) pro += (pop[i].F(j)-simplex[0][j])*normal[j];
		if(pro<trans) trans = pro;
	}
	for(i=0; i<dimF; i++) for(j=0; j<dimF; j++) simplex[i][j] += normal[j]*trans;

	// Step 1.4: extend the simplex
	std::vector<double> O(dimF);
	double ext = pow(1.0 + mUPFExtRatio, 1.0/(dimF-1.0)) - 1.0;
	for(i=0; i<dimF; i++) {O[i] = 0.0; for(j=0; j<dimF; j++) O[i] += simplex[j][i]; O[i] /= double(dimF);}
	for(i=0; i<dimF; i++) for(j=0; j<dimF; j++)   simplex[i][j] += ext*(simplex[i][j] - O[j]);

	// Step 2: define the reference points
	// Step 2.1: set the weights
	std::vector< std::vector< double > > weights;
	//if(dimF == 2)
	//{
	//	weights.resize(size);
	//	for(i=0; i<size; i++)
	//	{
	//		weights[i].resize(2);
	//		weights[i][0] = double(i)/double(size-1);
	//		weights[i][1] = 1.0 - weights[i][0];
	//	}
	//}
	//else if(dimF == 3)
	//{
	//	weights.resize(size);
	//	for(i=0; i<size; i++) {weights[i].resize(dimF); for(j=0; j<dimF; j++) weights[i][j] = W3D[j][i];}
	//}
	weights.resize(size); 
	std::vector<double> low(size), upp(size);
	for(i=0; i<size; i++) 
	{
		weights[i].resize(dimF);
		low[i] = 0.0;
		upp[i] = 1.0;
	}
	//alg::LHC(weights, low, upp);
	alg::Uniform(weights, low, upp);
	for(i=0; i<size; i++)
	{
		double sum = 0.0;
		for(j=0; j<dimF; j++) {weights[i][j] = -log(weights[i][j]); sum += weights[i][j];}
		for(j=0; j<dimF; j++) weights[i][j]/= sum;
	}

	// Step 2.2: generate reference points
	for(i=0; i<size; i++) for(j=0; j<dimF; j++)
	{
		cenp[i][j] = 0.0;
		for(k=0; k<dimF; k++) cenp[i][j] += simplex[k][j]*weights[i][k];
	}
}
} //namespace mod
} //namespace gen
} //namespace mea
} //namespace az
